<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>plot data</title>

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <link href="css/ip.grid.css" rel="stylesheet">

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
		<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
        <script src="js/jquery-ui-1.9.2.custom.min.js"></script>
        <script src="js/ip.grid.js"></script>

        <script>
            $(document).ready(function () {
                $('#demo').ip_Grid({ rows: 10000,  cols: 26 });
            });
        </script>

        <style>
            body {
                background-color: #fff;
            }
            .gridContainer {
                position:relative;
                width:700px;
                height:500px;
            }

            #demo {
                width:100%;
                height:100%;
            }
        </style>

    </head>
    <body>
        <div class="gridContainer">
            <div id="demo"></div>
        </div>

        <div id="print">123</div>
        <button id="btn">get</button>

        <script>
            $("#btn").click(function(){
                $("#print").empty();

                let ranges = $('#demo').ip_GetRange();
                for(let i = 0; i<ranges.length; i++){
                    $("#print").append("<p><h1>"+"select: "+i+"</h1></p>");
                    let row_ini = ranges[i][0][0];
                    let col_ini = ranges[i][0][1];
                    let row_end = ranges[i][1][0];
                    let col_end = ranges[i][1][1];
                    let message;
                    for(j = row_ini;j<=row_end;j++){
                        $("#print").append("<p>");
                        for(k = col_ini;k<=col_end;k++){
                            let one_element = $('#demo').ip_GetElementValue(j,k);
                            $("#print").append(one_element+", ");
                        }
                        $("#print").append("</p>");
                    }
                }

                var data_to_save = [];
                let csvContent = "data:text/csv;charset=utf-8,";
                for(let i=0;i<10000;i++){
                    data_to_save.push([]);
                    for(let j=0;j<26;j++){
                        data_to_save[i].push($('#demo').ip_GetElementValue(i,j));
                    }
                }
                data_to_save.forEach(function(rowArray){
                    let row = rowArray.join(",");
                    csvContent += row + "\r\n"; // add carriage return
                });


                var encodedUri = encodeURI(csvContent);
                var link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "table.csv");
                document.body.appendChild(link); // Required for FF
                link.click(); // This will download the data file named "my_data.csv".

            });
        </script>




    </body>
</html>
